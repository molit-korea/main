ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .05,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .05,cex=3)+
ylim(0,250)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,250)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,300)
live2[live2$V14 != 1, 30] <- "gray"
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,300)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,300)+theme_bw()
live2[live2$V14 != 1, 30] <- "skyblue"
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,300)+theme_bw()
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,500)+theme_bw()
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,1000)+theme_bw()
ggplot()+
#  geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
#                            y=live2[live2$V14==1,17]),
#              width = 2, height = 2, col = live2[live2$V14==1,30],
#              alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(0,1000)+theme_bw()
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_bw()
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = -.5)+
geom_hline(yintercept = -.5)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = 0)+
geom_hline(yintercept = -.5)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = .5)+
geom_hline(yintercept = -.5)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = -.5)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = 1)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(0,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = .5)
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(-1,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = -1)
live2[live2$V14 != 1, 30] <- "blue"
ggplot()+
geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
y=live2[live2$V14==1,17]),
width = 2, height = 2, col = live2[live2$V14==1,30],
alpha = .2,cex=3)+
#  geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
#                            y=live2[live2$V14!=1,17]),
#              width = 2, height = 2, col = live2[live2$V14!=1,30],
#              alpha = .2,cex=3)+
ylim(-1,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = -1)
ggplot()+
#  geom_jitter(mapping = aes(x=live2[live2$V14 ==1,28],
#                            y=live2[live2$V14==1,17]),
#              width = 2, height = 2, col = live2[live2$V14==1,30],
#              alpha = .2,cex=3)+
geom_jitter(mapping = aes(x=live2[live2$V14!=1,28],
y=live2[live2$V14!=1,17]),
width = 2, height = 2, col = live2[live2$V14!=1,30],
alpha = .2,cex=3)+
ylim(-1,1000)+theme_void()+
geom_vline(xintercept = 1)+
geom_hline(yintercept = -1)
table(live.hoasmb.f$V3)
table(live.hoasmb.f)
live.hoasmb <- live.hoas%>%
filter(V85 >=82.5)
library(ggplot2)
library(dplyr)
library(stringr)
library(maptools)
library(sp)
library(rgdal)
library(tidyverse)
library(broom)
library(reshape2)
live.hoasmb <- live.hoas%>%
filter(V85 >=82.5)
live.hoasmb.f <- data.frame(table(live.hoasmb$V3))
name_kr = c("서울",
"부산",
"대구",
"인천",
"광주",
"대전",
"울산",
"세종",
"경기",
"강원",
"충북",
"충남",
"전북",
"전남",
"경북",
"경남",
"제주")
live.hoasmb.f$Var1 <- name_kr
str(live.hoasmb.f)
live.hoasmb.f$Var1 <- factor(live.hoasmb.f
$Var1, level = name_kr)
live.hoasmb.f$per <- round(live.hoasmb.f$Freq/sum(live.hoasmb.f$Freq)*100,2)
str(live.hoasmb.f)
live.hoasmb.f <- live.hoasmb.f%>%
arrange(desc(per))
table(live.hoasmb.f)
live.hoasmb.f
arrange(live.hoasmb.f$Var1)
live.hoasmb <- live.hoas%>%
filter(V85 >=82.5)
live.hoasmb.f <- data.frame(table(live.hoasmb$V3))
live.hoasmb.f
name_kr = c("서울",
"부산",
"대구",
"인천",
"광주",
"대전",
"울산",
"세종",
"경기",
"강원",
"충북",
"충남",
"전북",
"전남",
"경북",
"경남",
"제주")
live.hoasmb.f$Var1 <- name_kr
str(live.hoasmb.f)
live.hoasmb.f$Var1 <- factor(live.hoasmb.f
$Var1, level = name_kr)
live.hoasmb.f$per <- round(live.hoasmb.f$Freq/sum(live.hoasmb.f$Freq)*100,2)
str(live.hoasmb.f)
live.hoasmb.f
sum(live.hoasmb.f$Freq)
979/20133
table(live$V3)
as.data.frame(table(live$V3))
live.hoasmb%>%
filter(V286<=126)
library(ggplot2)
library(dplyr)
library(stringr)
library(maptools)
library(sp)
library(rgdal)
library(tidyverse)
library(broom)
library(reshape2)
live.hoasmb%>%
filter(V286<=126)%>%
nrow()
285/979
live.hoasmb%>%
filter(V286<=100)%>%
nrow()
221/979
live.hoasmb%>%
filter(V286<=50)%>%
nrow()
38/979
live.hoasmb%>%
filter(V286<=70)%>%
nrow()
quantile(live.R$V286,probs = .5)
125
live.hoasmb%>%
filter(V286<=125)%>%
nrow()
285/979
rm(list=ls())
table(live.p$V3)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(stringr)
library(maptools)
library(sp)
library(rgdal)
library(tidyverse)
library(broom)
library(reshape2)
live.R <- read.table("../data/live16.txt", header = F, sep = ",")
live.R <- read.table("./data/live16.txt", header = F, sep = ",")
live <-live.R[,c(1,3,10,14,84,85,127,128,
200,201,211,212,277,
281,282,286,287,288,289,
295,300,306,307,309,311,312)]
live$age1 <- 2017-live$V211
live[live$V286 == 9999999,16] <- NA
hl <- live%>%
filter(V14 != 1 & V277 <= 1)
hl_money <- live%>%
filter(V286<=1000)
#live$V14
kind <- data.frame(table(live$V14),stringsAsFactors = F)
kind$Var1 <- c("자가","전세","보증금\n있는 월세","보증금\n없는 월세","사글세\n연세","무상")
kind$Var1 <- factor(kind$Var1,
levels = c("자가","전세","보증금\n있는 월세","보증금\n없는 월세","사글세\n연세","무상"),
labels = c("자가","전세","보증금\n있는 월세","보증금\n없는 월세","사글세\n연세","무상"))
str(kind)
names(kind) <- c("점유형태","빈도")
kind$per <- round(kind$`빈도`/sum(kind$`빈도`)*100,2)
kind
live$age.g <- "20대"
live[live$age1>=30&live$age1<40,28] <- "30대"
live[live$age1>=40&live$age1<50,28] <- "40대"
live[live$age1>=50&live$age1<60,28] <- "50대"
live[live$age1>=60&live$age1<70,28] <- "60대"
live[live$age1>=70&live$age1<80,28] <- "70대"
live[live$age1>=80,28] <- "80대 이상"
table(live$age.g)
live$kind <- "자가"
live[live$V14 != 1,29] <- "임대"
table(live$kind)
live.a <- as.data.frame(cbind("점유형태" = live$kind,
"연령" = live$age.g,
"거처종류"=live$V10))
live.ag.h <- as.data.frame(table(live.a[live.a$`점유형태`=="자가",2]))
live.ag.h$per <- round(live.ag.h$Freq/sum(live.ag.h$Freq)*100,2)
live.ag.hl <- as.data.frame(table(live.a[live.a$`점유형태`=="임대",2]))
live.ag.hl$per <- round(live.ag.hl$Freq/sum(live.ag.hl$Freq)*100,2)
live.ag <- rbind(live.ag.h[,-3], live.ag.hl[,-3])
live.ag.per <- rbind(live.ag.h[,-2], live.ag.hl[,-2])
names(live.ag) <- c("연령","빈도")
live.ag$kind <- c(rep("자가",7),rep("임대",7))
live.ag$kind <- factor(live.ag$kind,levels = c("자가","임대"))
names(live.ag.per) <- c("연령","per")
live.ag.per$kind <- c(rep("자가",7),rep("임대",7))
live.ag.per$kind <- factor(live.ag.per$kind,levels = c("자가","임대"))
live.h <- live%>%
filter(live$V14 == 1 & live$age1 >= 60)
live.h.f <- as.data.frame(table(live.h$V10))
str(live.h.f)
house <- c("일반단독",
"다가구단독",
"영업겸용단독",
"아파트",
"연립주택",
"다세대주택",
"비주거용\n건물내 주택",
"오피스텔",
"임시주거",
"기타")
live.h.f$Var1 <- house
live.h.f$Var1 <- factor(live.h.f$Var1,levels = house)
live.h.f$per <- round(live.h.f$Freq/sum(live.h.f$Freq)*100,2)
names(live.h.f) <- c("점유유형","빈도","per")
live.house.f <- data.frame(table(live$V10))
str(live.house.f)
live.house.f$Var1 <- house
live.house.f$Var1 <- factor(live.house.f$Var1,levels = house)
live.house.f$per <- round(live.house.f$Freq/sum(live.house.f$Freq)*100,2)
names(live.house.f) <- c("점유유형","빈도","per")
str(live.house.f)
live.p <- live.h%>%
filter(live.h$V10 == 4)
live.p.f <- data.frame(table(live.p$V277))
people <- c("1인","2인",
"3인","4인",
"5인","6인",
"7인","8인")
people.fix <- c("1인","2인",
"3인","4인",
"5인","6인이상")
people
str(live.p.f)
live.p.f$Var1 <- people
live.p.f$Var1 <- factor(live.p.f$Var1,levels = people)
live.p.f$per <- round(live.p.f$Freq/sum(live.p.f$Freq)*100,2)
names(live.p.f) <- c("거주인원","빈도","per")
live.p.f
live.p.fix <- live.p.f[1:6,]
live.p.fix$거주인원 <- as.character(live.p.fix$거주인원)
live.p.fix[6,2] <- sum(live.p.f[6:8,2])
live.p.fix[6,3] <- sum(live.p.f[6:8,3])
live.p.fix$거주인원 <- people.fix
live.p.fix$거주인원 <- factor(live.p.fix$거주인원,levels = people.fix)
live.p.fix
str(live.p.fix)
live.hoas <- live.p%>%
filter(V277 <= 2)
live.hoasmb <- live.hoas%>%
filter(V85 >=82.5)
live.hoasmb.f <- data.frame(table(live.hoasmb$V3))
name_kr = c("서울",
"부산",
"대구",
"인천",
"광주",
"대전",
"울산",
"세종",
"경기",
"강원",
"충북",
"충남",
"전북",
"전남",
"경북",
"경남",
"제주")
live.hoasmb.f$Var1 <- name_kr
str(live.hoasmb.f)
live.hoasmb.f$Var1 <- factor(live.hoasmb.f
$Var1, level = name_kr)
live.hoasmb.f$per <- round(live.hoasmb.f$Freq/sum(live.hoasmb.f$Freq)*100,2)
str(live.hoasmb.f)
live.hoasmb.f
live.hoasmb.f <- live.hoasmb.f%>%
arrange(desc(per))
table(live.p$V3)
table(live$V3)
table(live.hoasmb$V3)
187/3872
93/1361
3872/20133
187/20133
187/20133/0.1923211
country.p <- read.csv("./data/h.csv",stringsAsFactors = F)
country.p <- read.csv("../data/h.csv",stringsAsFactors = F)
country.p <- read.table("./data/h.txt",stringsAsFactors = F)
countty.p
country.p
country.p <- read.table("./data/h.txt",stringsAsFactors = F,sep=",")
country.p <- read.table("./data/h.txt",stringsAsFactors = F,sep=",",encoding = "UTF-8")
country.p <- read.table("./data/h.txt",sep=",",encoding = "UTF-8")
country.p
country.p <- read.table("./data/h.txt",sep=",",encoding = "ANSI")
country.p
country.p <- read.table("./data/h.txt",sep=",",encoding = "ANSI",header = T)
country.p <- read.table("./data/h.txt",sep=",",fileencoding = "UTF-8",header = T)
country.p <- read.csv("./data/housepeople_country2.csv",header = T)
country.p
country.p <- read.csv("./data/housepeople_country3.csv",header = T)
country.p
country <- country.p
table(live$V3)
table(live$V3)[1:17]
table(live$V3)[1]
table(live$V3)[[1]]
table(live$V3)[[1:17]]
table(live$V3)[[c(1:17)]]
str(table(live$V3)[1:17]
)
country$주거실태_전체 <- table(live$V3)
country$주거실태_전체 <- c(sum(table(live$V3)),table(live$V3))
country
country$조건 <- c(sum(table(live.hoasmb$V3)),table(live.hoasmb$V3))
country
country$prob <- country[,4]/country[,3]
country$추정가구 <- country$전체*country$prob
country
country$prob <- round(country[,4]/country[,3],2)
country$추정가구 <- country$전체*country$prob
country
country$prob <- round(country[,4]/country[,3],3)
country$추정가구 <- country$전체*country$prob
country
country$prob <- round(country[,4]/country[,3],8)
country$추정가구 <- country$전체*country$prob
country
write.csv(country, "./data/estimation.csv")
